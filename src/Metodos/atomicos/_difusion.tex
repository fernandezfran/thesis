% Copyright (c) 2024, Francisco Fernandez
% License: CC BY-SA 4.0
%   https://github.com/fernandezfran/thesis/blob/main/LICENSE
\subsubsection{Difusión}

Si un átomo permanece en las vecindades de un sitio por un periodo de tiempo lo 
suficientemente largo, comparado con el tiempo que demora en dar un salto hacia otro
sitio, entonces pierde memoria de donde vino y el próximo salto se dará hacia 
una dirección aleatoria. Se dice entonces que el movimiento del átomo es 
estocástico y que sigue una caminata aleatoria. Si esto se cumple, entonces, el 
desplazamiento cuadrático medio es proporcional al tiempo, donde la constante de 
proporcionalidad es el coeficiente de difusión de traza
\begin{equation}
    D^{*} = \frac{\langle \Delta r^2 \rangle}{2d\cdot t},
\end{equation}
donde $d$ es la dimensión del problema, $t$ el tiempo y 
$\langle \Delta r^2 \rangle$ el desplazamiento cuadrático medio, que en un 
sistema de $N$ átomos puede calcularse de la siguiente manera
\begin{equation}
    \langle \Delta r^2 \rangle = \frac{1}{N} \sum_{i=1}^{N} \langle |\vec{r_i}(t) - \vec{r_i}(t_0)|^2 \rangle.
\end{equation}

Si se conoce el coeficiente de difusión de traza, entonces el coeficiente de 
difusión químico puede obtenerse de la siguiente relación ~\cite{gomer1990}
\begin{equation}
    D = \left( \frac{\partial (\mu / k_BT)}{\partial ln \theta} \right)_T D^{*},
\end{equation}
donde $\mu$ es el potencial químico y $\theta$ es la concentración.

Usualmente, el tiempo que demora un átomo en dar un salto en una dinámica 
molecular a temperatura ambiente es muy largo, lo que impide tener una buena 
estadística en un tiempo de simulación razonable, por lo que es usual calcular 
el desplazamiento cuadrático medio a distintas temperaturas altas y extrapolar
el valor que se obtendría a temperatura ambiente mediante una ecuación de tipo 
Arrhenius, en la cual el coeficiente de difusión puede separarse en un 
prefactor $D_0$ y un término tipo Boltzmann,
\begin{equation}
    D = D_0 e^{-E / k_BT},
\end{equation}
donde $E$ es la energía de activación del proceso. 
